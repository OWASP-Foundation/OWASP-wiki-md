# Main

<div style="width:100%;height:160px;border:0,margin:0;overflow: hidden;">

![OWASP_Project_Header.jpg](OWASP_Project_Header.jpg
"OWASP_Project_Header.jpg")

</div>

<table>
<tbody>
<tr class="odd">
<td><p>valign="top" style="border-right: 1px dotted gray;padding-right:25px;"</p></td>
<td><p>-- <span style="color:#ff0000"> Instructions are in RED text and should be removed from your document by deleting the text with the span tags. This document is intended to serve as an example of what is required of an OWASP project wiki page. The text in red serves as instructions, while the text in black serves as an example. Text in black is expected to be replaced entirely with information specific to your OWASP project. </span> --&gt;</p>
<h2 id="owasp_wap___web_application_protection_project">OWASP WAP - Web Application Protection Project</h2>
<p>WAP is a tool to detect and correct input validation vulnerabilities in web applications written in PHP and predicts false positives. The tool combines source code static analysis and data mining to detect vulnerabilities and predict false positives. Then, corrects the source code to remove the real vulnerabilities inserting fixes (small functions) in the right places of the source e code.</p>
<h2 id="introduction">Introduction</h2>
<ul>
<li>OWASP WAP is a security tool to detect and remove input validation vulnerabilities in web applications, and predict false positives.</li>
<li>Uses source code static analysis to detect vulnerabilities, data mining to predict false positives and inserts fixes to correct the source code.</li>
<li>Detects and corrects 8 types of input validation vulnerabilities.</li>
<li>Teaches the user to build secure software.</li>
<li>Works on Linux, Macintosh and Windows.</li>
<li>Requires JRE to run.</li>
<li>Portable, ready to run and no installation required.</li>
</ul>
<h2 id="description">Description</h2>
<p>-- <span style="color:#ff0000"></p>
<p><code>   This is where you need to add your more robust project description. A project description should outline the purpose of the project, how it is used, and the value it provides to application security. Ideally, project descriptions should be written in such a way that there is no question what value the project provides to the software security community. This section will be seen and used in various places within the Projects Portal. Poorly written project descriptions therefore detract from a project’s visibility, so project leaders should ensure that the description is meaningful.  </code></p>
<p></span> --&gt; WAP is a source code static analysis and data mining tool to detect and correct input validation vulnerabilities in web applications written in PHP (version 4.0 or higher) with a low rate of false positives.</p>
<p>WAP detects and corrects the following vulnerabilities:</p>
<ul>
<li>SQL Injection (SQLI)</li>
<li>Cross-site scripting (XSS)</li>
<li>Remote File Inclusion (RFI)</li>
<li>Local File Inclusion (LFI)</li>
<li>Directory Traversal or Path Traversal (DT/PT)</li>
<li>Source Code Disclosure (SCD)</li>
<li>OS Command Injection (OSCI)</li>
<li>PHP Code Injection</li>
</ul>
<p>This tool semantically analyses the source code. More precisely, it does taint analysis (data-flow analysis) to detect the input validation vulnerabilities. The aim of the taint analysis is to track malicious inputs inserted by entry points ($_GET, $_POST arrays) and to verify if they reach some sensitive sink (PHP functions that can be exploited by malicious input, such as mysql_query). After the detection, the tool uses data mining to confirm if the vulnerabilities are real or false positives. At the end, the real vulnerabilities are corrected by the insertion of the fixes (small pieces of code) in the source code.</p>
<p>WAP is constituted by three modules:</p>
<ul>
<li>Code Analyzer: composed by tree generator and taint analyser. The tool has integrated a lexer and a parser generated by ANTLR, and based in a grammar and a tree grammar written to PHP language. The tree generator uses the lexer and the parser to build the AST (Abstract Sintatic Tree) to each PHP file. The taint analyzer performs the taint analysis navigating through the AST to detect potentials vulnerabilities.</li>
</ul>
<ul>
<li>False Positives Predictor: composed by a supervised trained data set with instances classified as being vulnerabilities and false positives and by the Logistic Regression machine learning algorithm. For each potential vulnerability detected by code analyser, this module collects the presence of the attributes that define a false positive and creates with them an instance. Then, the Logistic Regression algorithm receives the instances and classifies them as being a false positive or not (real vulnerability).</li>
</ul>
<ul>
<li>Code Corrector: each real vulnerability is removed by correction of its source code. This module for the type of vulnerability selects the fix that removes the vulnerability and signalizes the places in the source code where the fix will be inserted. Then, the code is corrected with the insertion of the fixes and new files are created. Fixes are small pieces of the code (small PHP functions developed to the effect) that performing sanitization or validation of the user inputs, depending of the vulnerability type.</li>
</ul>
<h2 id="licensing">Licensing</h2>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the <a href="http://www.gnu.org/licenses/agpl-3.0.html">link GNU Affero General Public License 3.0</a> as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p></td>
<td><p>valign="top" style="padding-left:25px;width:200px;border-right: 1px dotted gray;padding-right:25px;"</p></td>
<td><h2 id="project_resources">Project Resources</h2>
<p>-- <span style="color:#ff0000"></p>
<p><code>   This is where you can link to the key locations for project files, including setup programs, the source code repository, online documentation, a Wiki Home Page, threaded discussions about the project, and Issue Tracking system, etc. </code></p>
<p></span> --&gt; <a href="http://awap.sourceforge.net"><a href="http://awap.sourceforge.net">http://awap.sourceforge.net</a></a></p>
<h2 id="project_leader">Project Leader</h2>
<p><a href="User:iberiam" title="wikilink">Ibéria Medeiros</a><br />
-- <a href="mailto:ibemed@gmail.com">Email</a><br />
<a href="https://sites.google.com/site/ibemed/">Homepage</a> --&gt;</p>
<h2 id="related_projects">Related Projects</h2>
<p>-- <span style="color:#ff0000"></p>
<p><code>   This is where you can link to other OWASP Projects that are similar to yours. </code></p>
<p></span> --&gt;</p>
<h2 id="classifications">Classifications</h2>
<table>
<tbody>
<tr class="odd">
<td><p>colspan="2" align="center"</p></td>
<td><figure>
<img src="Project_Type_Files_TOOL.jpg" title="Project_Type_Files_TOOL.jpg" alt="Project_Type_Files_TOOL.jpg" /><figcaption>Project_Type_Files_TOOL.jpg</figcaption>
</figure></td>
</tr>
<tr class="even">
<td><p>align="center" valign="top" width="50%" rowspan="2"</p></td>
<td><figure>
<img src="Owasp-incubator-trans-85.png" title="Owasp-incubator-trans-85.png" alt="Owasp-incubator-trans-85.png" /><figcaption>Owasp-incubator-trans-85.png</figcaption>
</figure></td>
</tr>
<tr class="odd">
<td><p>align="center" valign="top" width="50%"</p></td>
<td><figure>
<img src="Owasp-breakers-small.png" title="Owasp-breakers-small.png" alt="Owasp-breakers-small.png" /><figcaption>Owasp-breakers-small.png</figcaption>
</figure></td>
</tr>
<tr class="even">
<td><p>colspan="2" align="center"</p></td>
<td><figure>
<img src="Agplv3-155x51.png" title="Agplv3-155x51.png" alt="Agplv3-155x51.png" /><figcaption>Agplv3-155x51.png</figcaption>
</figure></td>
</tr>
</tbody>
</table></td>
<td><p>valign="top" style="padding-left:25px;width:200px;"</p></td>
<td><h2 id="news_and_events">News and Events</h2>
<p>-- <span style="color:#ff0000"></p>
<p><code>   This is where you can provide project updates, links to any events like conference presentations, Project Leader interviews, case studies on successful project implementations, and articles written about your project. </code></p>
<p></span> --&gt;</p>
<ul>
<li>02.Out.2015 - A new version of WAP is available - WAP v2.0.2<br />
</li>
<li>WAP in Instituto Federal Catarinense, Blumenau, Brasil<br />
</li>
<li>WAP in Universidade Federal do Amazonas, Manaus, Brasil<br />
</li>
<li><a href="https://www.facebook.com/semanadascienciasetecnologiasaaue/photos/pb.701934916585847.-2207520000.1430093295./720636151382390/?type=3&amp;theater">WAP in 4th SCT of University of Évora</a><br />
</li>
<li><a href="https://paris-isp.uni.lu">WAP in ParIS - ISP at University of Luxembourg</a><br />
</li>
<li><a href="http://iscte.acm.org/event/web-application-protection/">WAP in ACM Student Chapter at ISCTE-IUL</a><br />
</li>
<li><a href="http://awap.sourceforge.net/news.html">Many articles are talking about WAP</a><br />
</li>
<li><a href="http://2014.dsn.org/">WAP in DSN Conference</a><br />
</li>
<li><a href="https://mocho.di.fc.ul.pt/mod/resource/view.php?id=13019">Seminar about WAP</a><br />
</li>
<li><a href="http://www2014.kr/">WAP in WWW Conference, in the research track Security 1</a><br />
</li>
<li><a href="http://www.indin2013.org/n/">WAP in INDIN Conference</a><br />
</li>
</ul></td>
</tr>
</tbody>
</table>

# FAQs

\-- <span style="color:#ff0000">

`   Many projects have "Frequently Asked Questions" documents or pages. However, the point of such a document is not the questions. `*`The``
 ``point``   ``of``   ``a``   ``document``   ``like``   ``this``
 ``are``   ``the``
 `**`answers`***`. The document contains the answers that people would otherwise find themselves giving over and over again. The idea is that rather than laboriously compose and post the same answers repeatedly, people can refer to this page with pre-prepared answers. Use this space to communicate your projects 'Frequent Answers.'`

</span> --\>

None, for now...

# Acknowledgements

## Contributors

OWASP WAP - Web Application Protection is brought to you by OWASP, a
free and open software security community focusing on improving the
security of software. Our goal with OWASP WAP project is to build secure
software, by the detection of web application vulnerabilities and
removing of them by the correction of web application source code.

OWASP WAP - Web Application Protection project is led by [Ibéria
Medeiros](user:iberiam "wikilink"), a software security developer and
enthusiast.

## Volunteers

The project is free and open source, and if you want to join to the
development team, please contact the project leader by sending her an
[email](mailto:iberia.medeiros@owasp.org).

## Acknowledgements

We would like to thank the following people and organizations for their
support:

  - [Professor Miguel P. Correia](http://www.gsd.inesc-id.pt/~mpc/)
  - [Professor Nuno Neves](http://www.di.fc.ul.pt/~nuno/)
  - EC through project FP7-607109 (SEGRID), and by national funds
    through Fundação para a Ciência e a Tecnologia (FCT) with references
    UID/CEC/50021/2013 (INESC-ID) and UID/CEC/00408/2013 (LaSIGE).

![FCT_H_color_v2011.png](FCT_H_color_v2011.png
"FCT_H_color_v2011.png")

\--

## Others

  - [Ibéria Medeiros](mailto:ibemed@gmail.com)

\--\>

# Road Map and Getting Involved

The main goals are:

1.  Demonstrate using the tool that there is a lack of software security
    in the development of web applications,
2.  Help programmers learn the need of secure codding practices, which
    are the practices and how they are implemented.
3.  Help programmers learn how to build secure software.
4.  Become a test bed for analyzing the QoS security of source code of
    web application.
5.  Become a tool to teach software security in web application in a
    class room/lab environment.
6.  Attract people to extend the WAP tool to detect and correct new
    types of vulnerabilities,

The phases of development of the WAP tool:

1\. Build a PHP parser to create an abstract syntax tree (AST).
(progress: concluded)
2\. Detect candidate vulnerabilities using taint analysis under the
AST.
(progress: concluded)
These two phases can be improved by implementing the new characteristics
of the PHP language, such as of object oriented.

3\. Predict if the candidate vulnerabilities are false positives or not,
using for this data mining with a defined training data set.
(progress: concluded)
This phase could be modified if the training data set grows vertically
and/or horizontally, i.e. more instances are included and/or new
attributes that characterize false positives are added to the instances.

4\. Correct the source code, removing the real vulnerabilities inserting
fixes in the right places of the source code.
(progress: partially concluded)
This task needs some improvements when the line of the source code
occupy more than 1 line.

5\. Output the results: vulnerabilities found, its correction and the
new corrected files; and the false positives predicted.
(progress: concluded)

## Getting Involved

Involvement in the development and promotion of OWASP WAP is actively
encouraged\! You do not have to be a security expert in order to
contribute. Some of the ways you can help:

  - Spread the word - Facebook, Twitter, Google+ or any other
    communication platform.
  - Write about OWASP WAP on your web site, book or blog.
  - Make tutorials/videos of WAP tool in languages you know of.
  - Include it in your training materials, talks, laboratories etc.

### Coding

You can also help if you wish to extend the WAP tool with a new module
or even improving some part(s) of it.

### Feedback

Feedback should be sent to the project leader by sending her an
[email](mailto:iberia.medeiros@owasp.org).

# Events and Publications

### Events

WAP in Instituto Federal Catarinense, Blumenau, Brasil

  - Miguel Correia presented the comunication: ***Protection of Web
    Applications with the WAP Tool***. Aug 2015.


WAP in Universidade Federal do Amazonas, Manaus, Brasil

  - Miguel Correia presented the comunication: ***Protection of Web
    Applications with Data Mining to Detect False Positives***. Jul
    2015.


[WAP in 4th SCT of University of
Évora](https://www.facebook.com/semanadascienciasetecnologiasaaue/photos/pb.701934916585847.-2207520000.1430093295./720636151382390/?type=3&theater)

  - Miguel Correia presented the comunication: ***Cyber-attacks againts
    PHP Web Applications and How avoid them with the WAP tool***. Apr
    2015.


[WAP in ParIS - ISP at University of
Luxembourg](https://paris-isp.uni.lu)

  - Ibéria Medeiros presented WAP and realized a lab in the Intensive
    Study Programmed (ISP). March 2015.


[WAP in ACM Student Chapter at
ISCTE-IUL](http://iscte.acm.org/event/web-application-protection/)

  - Ibéria Medeiros presented the WAP tool in the ACM Student Chapter.
    March 2015.


[Many articles are talking about
WAP](http://awap.sourceforge.net/news.html)

[WAP in DSN Conference](http://2014.dsn.org/)

  - Miguel Correia presented the comunication: ***Web Application
    Protection with the WAP tool***. June 2014.


[Seminar about
WAP](https://mocho.di.fc.ul.pt/mod/resource/view.php?id=13019)

  - Ibéria Medeiros presented a seminar: ***Hybrid Methods to Detect and
    Correct Web Application Vulnerabilities Automatically***. May
    2014.


[WAP in WWW Conference, in the research track
Security 1](http://www2014.kr/)

  - Ibéria Medeiros presented the comunication: ***Automatic Detection
    and Correction of Web Application Vulnerabilities using Data Mining
    to Predict False Positive***s. April 2014.


[WAP in INDIN Conference](http://www.indin2013.org/n/)

  - Ibéria Medeiros presented the comunication: ***Securing Energy
    Metering Software with Automatic Source Code Correction***. July
    2013.

### Publications

  - Ibéria Medeiros, Nuno Neves, Miguel Correia. ***Detecting and
    Removing Web Application Vulnerabilities with Static Analysis and
    Data Mining***. IEEE Transactions on Reliability, July 2015.
    ([journal](http://awap.sourceforge.net/papers/WAP_IEEE_TR_2015.pdf))

<!-- end list -->

  - Ibéria Medeiros, Nuno Neves, Miguel Correia. ***Web Application
    Protection with the WAP tool*** (fast abstract). Proceedings of the
    44th IEEE/IFIP International Conference on Dependable Systems and
    Networks (DSN'14), Atlanta, Georgia USA, June 2014.
    ([paper](http://awap.sourceforge.net/papers/DSN14-fa.pdf))

<!-- end list -->

  - Ibéria Medeiros, Nuno Neves, Miguel Correia. ***Automatic Detection
    and Correction of Web Application Vulnerabilities using Data Mining
    to Predict False Positives***. Proceedings of the 23rd International
    Conference on World Wide Web (WWW), Seoul, Korea, 11 pages, April
    2014. ([paper](http://awap.sourceforge.net/papers/WWW14.pdf))

<!-- end list -->

  - Ibéria Medeiros, Nuno Neves, Miguel Correia. ***Securing Energy
    Metering Software with Automatic Source Code Correction***.
    Proceedings of the IEEE International Conference on Industrial
    Informatics (INDIN), Bochum, Germany, 6 pages, July 2013.
    ([paper](http://awap.sourceforge.net/papers/INDIN13.pdf))

# Download

The delivery of the project is a zip or tar.gz file containing:

  - a jar file with the WAP tool;
  - plain text file with the indications how to install and use the
    tool;
  - vulnerable PHP example files to demonstrate how to work the tool;
  - the source code of the tool.

The tool works in different operating systems -- Linux, OSx and Windows
-- and is available at <http://awap.sourceforge.net>

The requirements to run the tool are only the JRE (Java Runtime
Enviroment), which can be downloaded at
[<http://www.oracle.com>](http://www.oracle.com/us/downloads/index.html#menu-downloads).

No installation required.

__NOTOC__ <headertabs />

[Category:OWASP Project](Category:OWASP_Project "wikilink")
[Category:OWASP_Builders](Category:OWASP_Builders "wikilink")
[Category:OWASP_Defenders](Category:OWASP_Defenders "wikilink")
[Category:OWASP_Tool](Category:OWASP_Tool "wikilink")